<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>案例-键盘控制方块移动</title>
		<style type="text/css">
			*{
				margin: 0;
				padding: 0;
			}
			#box{
				position:absolute;
				width: 80px;
				height: 80px;
				background: pink;
				margin: 50px auto;
			}
		</style>
	</head>
	<body>
		<div id="box"></div>
		<script>
			oBox = document.getElementById('box')
			let left = 0, Top = 0; 
			let timer = [];
			document.onkeydown = function(e){
				e = e || window.event
				switch(e.keyCode){
					case 37:
						if(timer[37] === undefined){
							(function move(){
								 left -= 3;
								oBox.style.left = left + "px"
								timer[37] = requestAnimationFrame(move)
							})();
						}
						break;
					case 38:
					if(timer[38] === undefined){
							(function move(){
								 Top -= 3
								oBox.style.top = Top + "px"
								timer[38] = requestAnimationFrame(move)
							})();
						}
						break;
					case 39:
					if(timer[39] === undefined){
						(function move(){
							 left += 3
							oBox.style.left = left + "px"
						 	 timer[39] = requestAnimationFrame(move)
						})();
					}
						break;
					case 40:
					if(timer[40] === undefined){
						(function move(){
							Top += 3
							oBox.style.top = Top + "px"
							timer[40] = requestAnimationFrame(move)
						})();
					}		
						break;
				}
			}
			document.onkeyup = function(e){
				e = e || window.event
				let keyCode = e.keyCode
				cancelAnimationFrame(timer[keyCode])
				timer[keyCode] = undefined
			}
		</script>
	</body>
</html>
